{"ast":null,"code":"import { mapGetters, mapActions } from 'vuex';\nexport default {\n  name: 'Alerts',\n  data() {\n    return {\n      showCreateModal: false,\n      editingRule: null,\n      ruleForm: {\n        name: '',\n        aoi_id: '',\n        condition: 'change_percentage',\n        threshold: 15,\n        email_enabled: true,\n        webhook_enabled: false,\n        is_active: true\n      }\n    };\n  },\n  computed: {\n    ...mapGetters('alerts', ['alerts', 'alertRules', 'isLoading']),\n    ...mapGetters('aoi', ['aois'])\n  },\n  methods: {\n    ...mapActions('alerts', ['fetchAlerts', 'fetchAlertRules', 'createAlertRule', 'updateAlertRule', 'deleteAlertRule']),\n    ...mapActions('aoi', ['fetchAOIs']),\n    async refreshData() {\n      try {\n        await Promise.all([this.fetchAlerts(), this.fetchAlertRules(), this.fetchAOIs()]);\n      } catch (error) {\n        console.error('Error refreshing data:', error);\n      }\n    },\n    editRule(rule) {\n      this.editingRule = rule;\n      this.ruleForm = {\n        ...rule\n      };\n      this.showCreateModal = true;\n    },\n    async saveRule() {\n      try {\n        if (this.editingRule) {\n          await this.updateAlertRule({\n            ...this.ruleForm,\n            id: this.editingRule.id\n          });\n        } else {\n          await this.createAlertRule(this.ruleForm);\n        }\n        this.closeModal();\n        await this.refreshData();\n      } catch (error) {\n        console.error('Error saving rule:', error);\n      }\n    },\n    async deleteRule(ruleId) {\n      if (confirm('Are you sure you want to delete this alert rule?')) {\n        try {\n          await this.deleteAlertRule(ruleId);\n          await this.refreshData();\n        } catch (error) {\n          console.error('Error deleting rule:', error);\n        }\n      }\n    },\n    async dismissAlert(alertId) {\n      // TODO: Implement alert dismissal\n      console.log('Dismiss alert:', alertId);\n    },\n    closeModal() {\n      this.showCreateModal = false;\n      this.editingRule = null;\n      this.ruleForm = {\n        name: '',\n        aoi_id: '',\n        condition: 'change_percentage',\n        threshold: 15,\n        email_enabled: true,\n        webhook_enabled: false,\n        is_active: true\n      };\n    },\n    getAlertClass(level) {\n      const classes = {\n        'info': 'alert-info',\n        'warning': 'alert-warning',\n        'error': 'alert-danger',\n        'success': 'alert-success'\n      };\n      return classes[level] || 'alert-info';\n    },\n    formatDate(dateString) {\n      return new Date(dateString).toLocaleDateString();\n    }\n  },\n  async mounted() {\n    await this.refreshData();\n  }\n};","map":{"version":3,"names":["mapGetters","mapActions","name","data","showCreateModal","editingRule","ruleForm","aoi_id","condition","threshold","email_enabled","webhook_enabled","is_active","computed","methods","refreshData","Promise","all","fetchAlerts","fetchAlertRules","fetchAOIs","error","console","editRule","rule","saveRule","updateAlertRule","id","createAlertRule","closeModal","deleteRule","ruleId","confirm","deleteAlertRule","dismissAlert","alertId","log","getAlertClass","level","classes","formatDate","dateString","Date","toLocaleDateString","mounted"],"sources":["C:\\Users\\ASUS\\OneDrive\\ÁîªÂÉè\\„Éâ„Ç≠„É•„É°„É≥„Éà\\Desktop\\cursor demo\\frontend\\src\\views\\Alerts.vue"],"sourcesContent":["<template>\r\n  <div class=\"alerts\">\r\n    <div class=\"row\">\r\n      <div class=\"col-12\">\r\n        <h1 class=\"mb-4\">üîî Alerts & Notifications</h1>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Alert Rules -->\r\n    <div class=\"row mb-4\">\r\n      <div class=\"col-12\">\r\n        <div class=\"card\">\r\n          <div class=\"card-header d-flex justify-content-between align-items-center\">\r\n            <h5 class=\"mb-0\">Alert Rules</h5>\r\n            <button class=\"btn btn-primary\" @click=\"showCreateModal = true\">\r\n              <i class=\"bi bi-plus-circle\"></i> Create Alert Rule\r\n            </button>\r\n          </div>\r\n          <div class=\"card-body\">\r\n            <div v-if=\"isLoading\" class=\"text-center\">\r\n              <div class=\"spinner-border text-primary\" role=\"status\">\r\n                <span class=\"visually-hidden\">Loading...</span>\r\n              </div>\r\n            </div>\r\n            <div v-else-if=\"alertRules.length === 0\" class=\"text-center text-muted\">\r\n              <p>No alert rules configured. Create your first rule to get started.</p>\r\n            </div>\r\n            <div v-else>\r\n              <div class=\"table-responsive\">\r\n                <table class=\"table table-hover\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th>Name</th>\r\n                      <th>AOI</th>\r\n                      <th>Condition</th>\r\n                      <th>Threshold</th>\r\n                      <th>Status</th>\r\n                      <th>Actions</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    <tr v-for=\"rule in alertRules\" :key=\"rule.id\">\r\n                      <td>{{ rule.name }}</td>\r\n                      <td>{{ rule.aoi_name }}</td>\r\n                      <td>{{ rule.condition }}</td>\r\n                      <td>{{ rule.threshold }}</td>\r\n                      <td>\r\n                        <span class=\"badge\" :class=\"rule.is_active ? 'bg-success' : 'bg-secondary'\">\r\n                          {{ rule.is_active ? 'Active' : 'Inactive' }}\r\n                        </span>\r\n                      </td>\r\n                      <td>\r\n                        <button class=\"btn btn-sm btn-outline-primary me-1\" @click=\"editRule(rule)\">\r\n                          <i class=\"bi bi-pencil\"></i>\r\n                        </button>\r\n                        <button class=\"btn btn-sm btn-outline-danger\" @click=\"deleteRule(rule.id)\">\r\n                          <i class=\"bi bi-trash\"></i>\r\n                        </button>\r\n                      </td>\r\n                    </tr>\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Recent Alerts -->\r\n    <div class=\"row\">\r\n      <div class=\"col-12\">\r\n        <div class=\"card\">\r\n          <div class=\"card-header\">\r\n            <h5 class=\"mb-0\">Recent Alerts</h5>\r\n          </div>\r\n          <div class=\"card-body\">\r\n            <div v-if=\"alerts.length === 0\" class=\"text-center text-muted\">\r\n              <p>No recent alerts</p>\r\n            </div>\r\n            <div v-else>\r\n              <div v-for=\"alert in alerts\" :key=\"alert.id\" class=\"alert\" :class=\"getAlertClass(alert.level)\">\r\n                <div class=\"d-flex justify-content-between align-items-start\">\r\n                  <div>\r\n                    <h6 class=\"alert-heading\">{{ alert.title }}</h6>\r\n                    <p class=\"mb-1\">{{ alert.message }}</p>\r\n                    <small class=\"text-muted\">\r\n                      AOI: {{ alert.aoi_name }} | {{ formatDate(alert.created_at) }}\r\n                    </small>\r\n                  </div>\r\n                  <button class=\"btn-close\" @click=\"dismissAlert(alert.id)\"></button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Create/Edit Modal -->\r\n    <div class=\"modal fade\" :class=\"{ show: showCreateModal }\" :style=\"{ display: showCreateModal ? 'block' : 'none' }\" tabindex=\"-1\">\r\n      <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h5 class=\"modal-title\">{{ editingRule ? 'Edit Alert Rule' : 'Create Alert Rule' }}</h5>\r\n            <button type=\"button\" class=\"btn-close\" @click=\"closeModal\"></button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <form @submit.prevent=\"saveRule\">\r\n              <div class=\"mb-3\">\r\n                <label class=\"form-label\">Rule Name *</label>\r\n                <input v-model=\"ruleForm.name\" type=\"text\" class=\"form-control\" required>\r\n              </div>\r\n              \r\n              <div class=\"mb-3\">\r\n                <label class=\"form-label\">AOI *</label>\r\n                <select v-model=\"ruleForm.aoi_id\" class=\"form-select\" required>\r\n                  <option value=\"\">Select an AOI</option>\r\n                  <option v-for=\"aoi in aois\" :key=\"aoi.id\" :value=\"aoi.id\">\r\n                    {{ aoi.name }}\r\n                  </option>\r\n                </select>\r\n              </div>\r\n              \r\n              <div class=\"row\">\r\n                <div class=\"col-md-6 mb-3\">\r\n                  <label class=\"form-label\">Condition</label>\r\n                  <select v-model=\"ruleForm.condition\" class=\"form-select\">\r\n                    <option value=\"change_percentage\">Change Percentage</option>\r\n                    <option value=\"vegetation_loss\">Vegetation Loss</option>\r\n                    <option value=\"urban_expansion\">Urban Expansion</option>\r\n                    <option value=\"water_changes\">Water Changes</option>\r\n                  </select>\r\n                </div>\r\n                <div class=\"col-md-6 mb-3\">\r\n                  <label class=\"form-label\">Threshold</label>\r\n                  <input v-model=\"ruleForm.threshold\" type=\"number\" class=\"form-control\" min=\"0\" step=\"0.1\">\r\n                </div>\r\n              </div>\r\n              \r\n              <div class=\"mb-3\">\r\n                <label class=\"form-label\">Notification Method</label>\r\n                <div class=\"form-check\">\r\n                  <input v-model=\"ruleForm.email_enabled\" class=\"form-check-input\" type=\"checkbox\" id=\"emailEnabled\">\r\n                  <label class=\"form-check-label\" for=\"emailEnabled\">Email Notifications</label>\r\n                </div>\r\n                <div class=\"form-check\">\r\n                  <input v-model=\"ruleForm.webhook_enabled\" class=\"form-check-input\" type=\"checkbox\" id=\"webhookEnabled\">\r\n                  <label class=\"form-check-label\" for=\"webhookEnabled\">Webhook Notifications</label>\r\n                </div>\r\n              </div>\r\n              \r\n              <div class=\"form-check mb-3\">\r\n                <input v-model=\"ruleForm.is_active\" class=\"form-check-input\" type=\"checkbox\" id=\"ruleActive\">\r\n                <label class=\"form-check-label\" for=\"ruleActive\">\r\n                  Rule is active\r\n                </label>\r\n              </div>\r\n            </form>\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button type=\"button\" class=\"btn btn-secondary\" @click=\"closeModal\">Cancel</button>\r\n            <button type=\"button\" class=\"btn btn-primary\" @click=\"saveRule\">\r\n              {{ editingRule ? 'Update' : 'Create' }} Rule\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- Modal backdrop -->\r\n    <div v-if=\"showCreateModal\" class=\"modal-backdrop fade show\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters, mapActions } from 'vuex'\r\n\r\nexport default {\r\n  name: 'Alerts',\r\n  data() {\r\n    return {\r\n      showCreateModal: false,\r\n      editingRule: null,\r\n      ruleForm: {\r\n        name: '',\r\n        aoi_id: '',\r\n        condition: 'change_percentage',\r\n        threshold: 15,\r\n        email_enabled: true,\r\n        webhook_enabled: false,\r\n        is_active: true\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters('alerts', ['alerts', 'alertRules', 'isLoading']),\r\n    ...mapGetters('aoi', ['aois'])\r\n  },\r\n  methods: {\r\n    ...mapActions('alerts', ['fetchAlerts', 'fetchAlertRules', 'createAlertRule', 'updateAlertRule', 'deleteAlertRule']),\r\n    ...mapActions('aoi', ['fetchAOIs']),\r\n    \r\n    async refreshData() {\r\n      try {\r\n        await Promise.all([\r\n          this.fetchAlerts(),\r\n          this.fetchAlertRules(),\r\n          this.fetchAOIs()\r\n        ])\r\n      } catch (error) {\r\n        console.error('Error refreshing data:', error)\r\n      }\r\n    },\r\n    \r\n    editRule(rule) {\r\n      this.editingRule = rule\r\n      this.ruleForm = { ...rule }\r\n      this.showCreateModal = true\r\n    },\r\n    \r\n    async saveRule() {\r\n      try {\r\n        if (this.editingRule) {\r\n          await this.updateAlertRule({ ...this.ruleForm, id: this.editingRule.id })\r\n        } else {\r\n          await this.createAlertRule(this.ruleForm)\r\n        }\r\n        this.closeModal()\r\n        await this.refreshData()\r\n      } catch (error) {\r\n        console.error('Error saving rule:', error)\r\n      }\r\n    },\r\n    \r\n    async deleteRule(ruleId) {\r\n      if (confirm('Are you sure you want to delete this alert rule?')) {\r\n        try {\r\n          await this.deleteAlertRule(ruleId)\r\n          await this.refreshData()\r\n        } catch (error) {\r\n          console.error('Error deleting rule:', error)\r\n        }\r\n      }\r\n    },\r\n    \r\n    async dismissAlert(alertId) {\r\n      // TODO: Implement alert dismissal\r\n      console.log('Dismiss alert:', alertId)\r\n    },\r\n    \r\n    closeModal() {\r\n      this.showCreateModal = false\r\n      this.editingRule = null\r\n      this.ruleForm = {\r\n        name: '',\r\n        aoi_id: '',\r\n        condition: 'change_percentage',\r\n        threshold: 15,\r\n        email_enabled: true,\r\n        webhook_enabled: false,\r\n        is_active: true\r\n      }\r\n    },\r\n    \r\n    getAlertClass(level) {\r\n      const classes = {\r\n        'info': 'alert-info',\r\n        'warning': 'alert-warning',\r\n        'error': 'alert-danger',\r\n        'success': 'alert-success'\r\n      }\r\n      return classes[level] || 'alert-info'\r\n    },\r\n    \r\n    formatDate(dateString) {\r\n      return new Date(dateString).toLocaleDateString()\r\n    }\r\n  },\r\n  \r\n  async mounted() {\r\n    await this.refreshData()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.alerts {\r\n  padding: 20px;\r\n}\r\n\r\n.modal.show {\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.alert {\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.alert-heading {\r\n  margin-bottom: 0.5rem;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}